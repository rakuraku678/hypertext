                            %{
                              connectionsDepartureCount = _flight.departureSegment.flightsCount.getAsInt() - 1;
                              connectionsReturnCount = _flight.returnSegment.flightsCount.getAsInt() - 1;
                              returnElapsedTimeEX = _flight.returnSegment.elapsedTime.getAsInt();
                              departureElapsedTimeEX = _flight.departureSegment.elapsedTime.getAsInt(); 
                            }%
                            
<div class="row ticket ticketBaxer" 
		data-airportReturn="${_flight.returnAirportCode.getAsString()}" 
		data-airportDeparture="${_flight.departureAirportCode.getAsString()}" 
		data-departureElapsedTime="${departureElapsedTimeEX}"
		data-returnElapsedTime="${returnElapsedTimeEX}" 
		data-returntime="${_flight.returnSegment.departureTime.getAsString()}" 
		data-departuretime="${_flight.departureSegment.departureTime.getAsString()}" 
		data-price="${_flight.pricing.totalPassengerFare.getAsString()}"
		data-airline="${_flight.departureSegment.detail.get(0).operatingAirlineCode.getAsString()}" 
		data-escala="${connectionsDepartureCount}"
		data-returnEscala="${connectionsReturnCount}">
    <form class="form-ticket" action="@{PaymentFlowController.index}" method="post">
    	<input type="hidden" name="selectedCurrency" class="selCurrency" value="usd" id="hdnSelectedCurrency"/>
    	
        <div class="col-md-9 info-flight">
            <ul>
                <li class="txt-airport-date">
                    <ul>
                        <li>
                            <i class="icon-fly"></i>
                            <span class="leaving">ida</span>
                            <span class="fly-day">${_flight.departureDate.getAsString()}</span>
                        </li>
                        <li>
                            <span class="airport">${controllers.SearchController.getAirportName(_flight.departureAirportCode.getAsString())}</span>
                            <span class="description-airport">${_flight.departureAirportCode.getAsString()}</span>
                        </li>
                        <li>
                            <span class="airport">${controllers.SearchController.getAirportName(_flight.returnAirportCode.getAsString())}</span>
                            <span class="description-airport">${_flight.returnAirportCode.getAsString()}</span>
                        </li>
                    </ul>
                </li>
                <li class="txt-view-detail">
                    <ul>
                        <li>
                            <label style="font-weight: 500;">
                                #{list items:_flight.departureSegment.airlinesCodes, as:"airlineCode"}
                                	#{airlineLogo carriersCode:airlineCode?.getAsString().toLowerCase(), carriersName: airlineCode /}
                                	${_flightsResultsFilters?.carriersCodesXNames?.get(airlineCode.getAsString())}
                                #{/list}
                            </label>
                        </li>
                        <li class="hour-of-flight">
                            <span>${_flight.departureSegment.departureTime.getAsString()}</span>
                        </li>
                        <li class="stops-route">
                            <a type="button" data-toggle="collapse" data-target="#departureSegment${_flight.sequenceNumber.getAsString()}" aria-expanded="false" aria-controls="collapseExample" class="link-detail-desktop">
                                %{
                                    connectionsCount = _flight.departureSegment.flightsCount.getAsInt() - 1;
                                }%
                            #{if connectionsCount == 0 }
                                <span class="stop-txt">Directo</span>
                                <span class="line-route"></span>
                            #{/if}
                            #{elseif connectionsCount == 1 }
                                <span class="stop-txt">${connectionsCount} escala</span>
                                <span class="circle"></span>
                                <span class="line-route"></span>
                            #{/elseif}
                            #{elseif connectionsCount >= 2 }
                                <span class="stop-txt">${connectionsCount}&nbsp;escalas</span>
                                <span class="circle left-circle"></span>
                                <span class="circle right-circle"></span>
                                <span class="line-route"></span>
                            #{/elseif}
                            </a>
                        </li>
                        <li class="hour-of-flight">
                            <span>${_flight.departureSegment.returnTime.getAsString()}</span>
                        </li>
                        <li class="time">
                            %{
                            	departureElapsedTime = _flight.departureSegment.elapsedTime.getAsInt();
                                int departureElapsedHours = departureElapsedTime / 60;
                                int departureElapsedMinutes = departureElapsedTime % 60;
                            }%
                            <span>&{"%dh %02dm", departureElapsedHours, departureElapsedMinutes}</span>
                        </li>
                        <li class="detail">
                            <a type="button" data-toggle="collapse" data-target="#departureSegment${_flight.sequenceNumber.getAsString()}" aria-expanded="false" aria-controls="collapseExample" class="link-detail-desktop">
                                ver detalle
                            </a>
                            <a data-toggle="modal" data-target="#detailModalFlight" class="link-detail-mobile">detalle</a>
                        </li>

                        <div class="collapse" id="departureSegment${_flight.sequenceNumber.getAsString()}">
                            #{list items:_flight.departureSegment, as:'flightSegment'}
                                #{flightsItemDetail flightSegment:flightSegment, flightsResultsFilters:_flightsResultsFilters, bookingCodes: _flight.pricing.bookingCodes/}
                            #{/list}
                        </div>
                    </ul>
                </li>
                <li class="txt-airport-date">
                    <ul>
                        <li>
                            <i class="icon-fly-vuelta"></i>
                            <span class="leaving">vuelta</span>
                            <span class="fly-day">${_flight.returnDate.getAsString()}</span>
                        </li>
                        <li>
                            <span class="airport">${controllers.SearchController.getAirportName(_flight.returnAirportCode.getAsString())}</span>
                            <span class="description-airport">${_flight.returnAirportCode.getAsString()}</span>
                        </li>
                        <li>
                            <span class="airport">${controllers.SearchController.getAirportName(_flight.departureAirportCode.getAsString())}</span>
                            <span class="description-airport">${_flight.departureAirportCode.getAsString()}</span>
                        </li>
                    </ul>
                </li>
                <li class="txt-view-detail">
                    <ul>
                        <li>
                            <label style="font-weight: 500;">
                                #{list items:_flight.returnSegment.airlinesCodes, as:"airlineCode"}
                                	#{airlineLogo carriersCode:airlineCode?.getAsString().toLowerCase(), carriersName: airlineCode /}
                                	${_flightsResultsFilters?.carriersCodesXNames?.get(airlineCode.getAsString())}
                                #{/list}
                            </label>
                        </li>
                        <li class="hour-of-flight">
                            <span>${_flight.returnSegment.departureTime.getAsString()}</span>
                        </li>
                        <li class="stops-route">
                            <a type="button" data-toggle="collapse" data-target="#returnSegment${_flight.sequenceNumber.getAsString()}" aria-expanded="false" aria-controls="collapseExample2" class="link-detail-desktop">
                            %{
                                connectionsCount = _flight.returnSegment.flightsCount.getAsInt() - 1;
                            }%
                            #{if connectionsCount == 0 }
                                <span class="stop-txt">Directo</span>
                                <span class="line-route"></span>
                            #{/if}
                            #{if connectionsCount == 1 }
                                <span class="stop-txt">${connectionsCount} escala</span>
                                <span class="circle"></span>
                                <span class="line-route"></span>
                            #{/if}
                            #{if connectionsCount == 2 }
                                <span class="stop-txt">${connectionsCount}&nbsp;escalas</span>
                                <span class="circle left-circle"></span>
                                <span class="circle right-circle"></span>
                                <span class="line-route"></span>
                            #{/if}
                            </a>
                        </li>
                        <li class="hour-of-flight">
                            <span>${_flight.returnSegment.returnTime.getAsString()}</span>
                        </li>
                        <li class="time">
                        %{
                            returnElapsedTime = _flight.returnSegment.elapsedTime.getAsInt();
                            int returnElapsedHours = returnElapsedTime / 60;
                            int returnElapsedMinutes = returnElapsedTime % 60;
                            }%
                            <span>&{"%dh %02dm", returnElapsedHours, returnElapsedMinutes}</span>
                        </li>
                        <li class="detail">
                            <a type="button" data-toggle="collapse" data-target="#returnSegment${_flight.sequenceNumber.getAsString()}" aria-expanded="false" aria-controls="collapseExample2" class="link-detail-desktop">
                                ver detalle
                            </a>
                             <a data-toggle="modal" data-target="#detailModalFlight" class="link-detail-mobile">detalle</a>
                        </li>
                        </li>

                        <div class="collapse" id="returnSegment${_flight.sequenceNumber.getAsString()}">
                            #{list items:_flight.returnSegment, as:'flightSegment'}
                                #{flightsItemDetail flightSegment:flightSegment, flightsResultsFilters:_flightsResultsFilters, bookingCodes:_flight.pricing.bookingCodes/}
                            #{/list}
                        </div>
                    </ul>
                </li>
                *{<li class="txt-view-detail">}*
                    *{<ul>}*
                        *{<li class="radio">}*
                            *{<label><input type="radio" name="optionb"><img src="public/img/lan.jpg" title="" alt=""></label>}*
                        *{</li>}*
                        *{<li class="hour-of-flight">}*
                            *{<span>20:15</span>}*
                        *{</li>}*
                        *{<li class="stops-route">}*
                            *{<a href="">}*
                                *{<span class="stop-txt">3 escala</span>}*
                                *{<span class="circle left-circle"></span>}*
                                *{<span class="circle"></span>}*
                                *{<span class="circle right-circle"></span>}*
                                *{<span class="line-route"></span>}*
                            *{</a>}*
                        *{</li>}*
                        *{<li class="hour-of-flight">}*
                            *{<span>20:15</span>}*
                        *{</li>}*
                        *{<li class="time">}*
                            *{<span>18h 50m</span>}*
                        *{</li>}*
                        *{<li class="detail">}*
                            *{<a type="button" data-toggle="collapse" data-target="#collapseExample3" aria-expanded="false" aria-controls="collapseExample3" class="link-detail-desktop">}*
                                *{detalle}*
                            *{</a>}*
                             *{<a data-toggle="modal" data-target="#detailModalFlight" class="link-detail-mobile">detalle</a>}*
                        *{</li>}*
                        *{</li>}*

                        *{<div class="collapse" id="collapseExample3">}*
                            *{<div class="well">}*
                                *{...}*
                            *{</div>}*
                        *{</div>}*
                    *{</ul>}*
                *{</li>}*
            </ul>
        </div>

        <div class="col-md-3 ticket-detail">
            *{#{if false} }**{CAMBIAR ESTA CONDICION CUANDO VENGA LA INFO DE LA API}*
            *{<span class="last-ticket-available">}*
                *{<i class="icon-alert-ticket"></i>}*
                *{<span class="info-ticket-avaible">¡Últimos 2 lugares!</span>}*
            *{</span>}*
            *{#{/if}}*
            *{#{else}}*
                *{<span class="last-ticket-space-saver">&nbsp;</span>}*
            *{#{/else}}*
            #{if _flight.pricing.accountCode} *{CAMBIAR ESTA CONDICION CUANDO VENGA LA INFO DE LA API}*
            <span class="private-fare">
                <i class="icon-private-fare"></i>
                <span class="info-private-fare">Tarifa Exclusiva</span>
            </span>
            #{/if}
            #{else}
                *{<span class="private-fare-space-saver">&nbsp;</span>}*
            #{/else}
            #{if _flight.pricing.adtTotalPriceBeforeDiscount && _flight.pricing.adtTotalPriceBeforeDiscount != _flight.pricing.adtTotalPrice}
                <span class="private-fare-space-saver"><img src="http://res.cloudinary.com/hyvrprjak/image/upload/c_scale,w_60/v1488203856/superDosB.jpg" alt="Super Dos" title="super dos"></span>
            #{/if}
            <span class="title">Precio por Adulto</span>
            #{if _flight.pricing.adtTotalPriceBeforeDiscount && _flight.pricing.adtTotalPriceBeforeDiscount != _flight.pricing.adtTotalPrice}
            <span class="price before-discount"><span class="simbolCurrency">US$</span><span class="usdpriceCon">${_flight.pricing.adtTotalPriceBeforeDiscount?.getAsString()}</span><span class="clppriceCon hidden"></span></span>
            #{/if}
            <span class="price"><span class="simbolCurrency">US$</span><span class="usdpriceCon">${_flight.pricing.adtTotalPrice?.getAsString()}</span><span class="clppriceCon hidden"></span></span>
            <ul class="detail-price">
                <li><span class="item-detail">Pasajeros <span class="simbolCurrency">US$</span></span><span class="item-price usdpriceCon">${_flight.pricing.totalPassengerFare?.getAsString()}</span><span class="item-price clppriceCon hidden"></span></li>
                <li><span class="item-detail">Imp. y Tasas <span class="simbolCurrency">US$</span></span><span class="item-price usdpriceCon">${_flight.pricing.totalTax?.getAsString()}</span><span class="item-price clppriceCon hidden"></span></li>
                <li><span class="item-detail">Gestión agencia <span class="simbolCurrency">US$</span></span><span class="item-price usdpriceCon">${_flight.pricing.totalFee?.getAsString()}</span><span class="item-price clppriceCon hidden"></span></li>
                <hr>
                <li><span class="item-detail">Total <span class="simbolCurrency">US$</span></span><span class="item-price usdpriceCon">${_flight.pricing.totalAmount?.getAsString()}</span><span class="item-price clppriceCon hidden"></span></li>
            </ul>
            <div class="text-center box-ticket-submit">
                <input type="hidden" name="bfmResultItem" value="${_flight.toString()}">
                <input type="submit" class="btn btn-ticket" value="Seleccionar">
                *{<a class="btn btn-ticket" href="@{PaymentFlowController.index}">Comprar</a>}*

            </div>
        </div>
    </form>
</div>

<script type="text/javascript">
    $(function () {
        $('[data-toggle="tooltip"]').tooltip();
    })
    #{get 'moreScripts' /}
</script>

